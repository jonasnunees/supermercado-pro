<!DOCTYPE html>
<!-- Declara√ß√£o do tipo de documento HTML5 -->
<html lang="pt-br">
<!-- In√≠cio do documento HTML com idioma definido como portugu√™s brasileiro -->

<head>
    <!-- Se√ß√£o HEAD cont√©m metadados e links para arquivos externos -->
    
    <!-- Define a codifica√ß√£o de caracteres para UTF-8 (suporta acentua√ß√£o) -->
    <meta charset="UTF-8">
    
    <!-- Configura a visualiza√ß√£o responsiva em dispositivos m√≥veis -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- T√≠tulo que aparece na aba do navegador -->
    <title>Supermercado Pro - Controle Total</title>
    
    <!-- Link para o arquivo de estilos CSS externo -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Importa a biblioteca Supabase direto do CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
    <!-- Corpo da p√°gina - todo conte√∫do vis√≠vel fica aqui -->

    <!-- Cabe√ßalho com informa√ß√µes do usu√°rio -->
    <div class="user-header">
        <div class="user-info">
            <span id="user-name">üë§ Carregando...</span>
        </div>
        <button class="btn-logout" onclick="handleLogout()">Sair</button>
    </div>

    <!-- Container principal da compra atual -->
    <div class="container">
        <!-- T√≠tulo da se√ß√£o de compra atual com emoji -->
        <h2>üõí Compra Atual</h2>
        
        <!-- Painel com os valores (dispon√≠vel e gasto) -->
        <div class="dashboard">
            <!-- Card mostrando o valor dispon√≠vel (or√ßamento - gastos) -->
            <div class="stat-card bg-available">
                Dispon√≠vel
                <!-- Span que ser√° atualizado dinamicamente via JavaScript -->
                <span id="budget-display">R$ 0.00</span>
            </div>
            
            <!-- Card mostrando o total gasto na compra atual -->
            <div class="stat-card bg-spent">
                Total da Compra
                <!-- Span que ser√° atualizado dinamicamente via JavaScript -->
                <span id="current-total-display">R$ 0.00</span>
            </div>
        </div>

        <!-- Grupo de inputs para adicionar produtos -->
        <div class="input-group">
            <!-- Label explicativo para o campo de or√ßamento -->
            <label style="font-size: 0.8rem; color: var(--gray)">Defina seu Or√ßamento:</label>
            
            <!-- Input para definir o or√ßamento total dispon√≠vel -->
            <input type="number" id="total-budget" placeholder="R$ 0.00" step="0.01">
            
            <!-- Linha horizontal para separar visualmente as se√ß√µes -->
            <hr style="width:100%; border: 0.5px solid #eee; margin: 5px 0">
            
            <!-- Input para o nome do produto -->
            <input type="text" id="prod-name" placeholder="Nome do Produto">
            
            <!-- Container flex√≠vel para quantidade e pre√ßo ficarem lado a lado -->
            <div style="display: flex; gap: 10px;">
                <!-- Input para quantidade (n√∫mero inteiro, m√≠nimo 1) -->
                <input type="number" id="prod-qty" placeholder="Qtd" min="1" style="width: 30%;">
                
                <!-- Input para pre√ßo (permite decimais com step 0.01) -->
                <input type="number" id="prod-price" placeholder="Pre√ßo" step="0.01" style="width: 70%;">
            </div>
            
            <!-- Bot√£o que chama a fun√ß√£o addItem() quando clicado -->
            <button class="btn-add" onclick="addItem()">Adicionar Produto</button>
        </div>

        <!-- Container vazio que ser√° preenchido dinamicamente com a lista de produtos -->
        <div id="list-container"></div>
        
        <!-- Bot√£o para finalizar compra (inicialmente oculto, aparece quando h√° itens) -->
        <button id="btn-finish" class="btn-finish" onclick="finalizePurchase()" style="display:none">
            Finalizar e Salvar
        </button>
    </div>

    <!-- Se√ß√£o de filtros para o hist√≥rico -->
    <div class="filter-section">
        <!-- Select (dropdown) para escolher o m√™s -->
        <select id="filter-month">
            <option value="">Filtrar M√™s</option>
            <option value="0">Janeiro</option>
            <option value="1">Fevereiro</option>
            <option value="2">Mar√ßo</option>
            <option value="3">Abril</option>
            <option value="4">Maio</option>
            <option value="5">Junho</option>
            <option value="6">Julho</option>
            <option value="7">Agosto</option>
            <option value="8">Setembro</option>
            <option value="9">Outubro</option>
            <option value="10">Novembro</option>
            <option value="11">Dezembro</option>
        </select>
        
        <!-- Input para filtrar por ano -->
        <input type="number" id="filter-year" placeholder="Ano" min="2020">
        
        <!-- Bot√£o de busca que atualiza o hist√≥rico filtrado -->
        <button onclick="renderHistory()" style="background: var(--dark); color: white; width: auto;">üîç</button>
    </div>

    <!-- Box que mostra o total gasto no per√≠odo filtrado (inicialmente oculto) -->
    <div id="total-month-display" class="total-month-box" style="display:none">
        Gasto total no per√≠odo: R$ <span id="month-value">0.00</span>
    </div>

    <!-- Container para o hist√≥rico de compras anteriores -->
    <div class="container" style="background: transparent; box-shadow: none; padding-top: 0;">
        <!-- T√≠tulo da se√ß√£o de hist√≥rico -->
        <h3>üìú Compras Anteriores</h3>
        
        <!-- Container vazio que ser√° preenchido com o hist√≥rico via JavaScript -->
        <div id="history-container"></div>
    </div>

    <!-- Elemento de notifica√ß√£o (toast) que aparece temporariamente no canto da tela -->
    <div id="notification"></div>

    <!-- Link para o arquivo JavaScript externo -->
    <script src="js/script.js"></script>
</body>
</html>